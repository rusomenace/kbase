$Computers=Get-ADComputer -Filter {Name -Like "TQAR*" -and Name -NotLike "*W2K3*" -and Name -NotLike "*W2K8*" -and Name -NotLike "*W8*"  -and Name -NotLike "*W7*"  -and Name -NotLike "*VCENTER*" } | Sort-Object ; ForEach ($computer in $computers) {If (Test-Connection -ComputerName $computer.Name -Count 1 -Quiet) {Try {Invoke-Command -ComputerName $computer.Name -ScriptBlock {cmd /C wuauclt /detectnow};Invoke-Command -ComputerName $computer.Name -ScriptBlock {cmd /C wuauclt /reportnow};Write-Output "$($computer.Name) is done"} Catch {   Write-Host "$($computer.Name) failed with Error: "$Err} }  else {Write-Output "$($computer.Name) is offline"}}